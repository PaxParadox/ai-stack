{
  "name": "AI Search Assistant",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "search-assistant",
        "options": {}
      },
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "http://searxng:8080/search",
        "queryParameters": {
          "parameters": [
            {
              "name": "q",
              "value": "={{ $json.body.query }}"
            },
            {
              "name": "format",
              "value": "json"
            }
          ]
        }
      },
      "name": "Search Web",
      "type": "n8n-nodes-base.httpRequest",
      "position": [450, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://ollama:11434/api/generate",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "llama3.2:3b"
            },
            {
              "name": "prompt",
              "value": "Based on these search results: {{ $json.results }}\n\nAnswer this question: {{ $json.body.query }}"
            },
            {
              "name": "stream",
              "value": false
            }
          ]
        }
      },
      "name": "Generate Answer",
      "type": "n8n-nodes-base.httpRequest",
      "position": [650, 300]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "response",
              "value": "={{ $json.response }}"
            },
            {
              "name": "sources",
              "value": "={{ $json.results }}"
            }
          ]
        }
      },
      "name": "Format Response",
      "type": "n8n-nodes-base.set",
      "position": [850, 300]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [[{"node": "Search Web", "type": "main", "index": 0}]]
    },
    "Search Web": {
      "main": [[{"node": "Generate Answer", "type": "main", "index": 0}]]
    },
    "Generate Answer": {
      "main": [[{"node": "Format Response", "type": "main", "index": 0}]]
    }
  }
}
